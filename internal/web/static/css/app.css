/* --- Design tokens ------------------------------------------------------- */
:root{
  /* Light (default) */
  --fg:#111;
  --bg:#fafafa;
  --muted:#777;

  --card:#fff;
  --border:#eee;
  --surface:#f5f5f5;

  --btn-bg:#f5f5f5;
  --btn-border:#ddd;
  --btn-hover:#eee;

  --link:#0a58ca;
  --shadow:0 1px 2px rgba(0,0,0,.04);

  /* Heart Rate Zone Colors (Garmin Connect style) */
  --hr-zone-1: #94a3b8;  /* Zone 1 (Recovery) - Light gray */
  --hr-zone-2: #3b82f6;  /* Zone 2 (Base) - Blue */
  --hr-zone-3: #10b981;  /* Zone 3 (Aerobic) - Green */
  --hr-zone-4: #f59e0b;  /* Zone 4 (Threshold) - Orange */
  --hr-zone-5: #dc2626;  /* Zone 5 (VO2 Max) - Red */
}

/* --- Base ---------------------------------------------------------------- */
*{ box-sizing:border-box; }
html, body{ height:100%; }
body{
  margin:0;
  font:15px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Ubuntu;
  color:var(--fg);
  background:var(--bg);
}
a{ color:var(--link); }

/* Layout */
.container{ max-width:1100px; margin:32px auto; padding:0 16px; }

/* --- Topbar -------------------------------------------------------------- */
/* make the header a flex row so we can push controls to the right */
.topbar{
  position:sticky; top:0;
  background:var(--card);
  border-bottom:1px solid var(--border);
  padding:10px 16px;
  display:flex; align-items:center; gap:8px;
  z-index:1000;
  box-shadow:var(--shadow);
}
.topbar a{ text-decoration:none; color:var(--fg); font-weight:400; margin: 0 5px; }
#logo { font-weight:800; font-size: 20px; }
.nav{ width:100%; display:flex; align-items:center; justify-content:space-between; gap:12px; }
.nav-links{ display:flex; align-items:center; gap:12px; }
.nav-auth{ margin-left:auto; display:flex; align-items:center; gap:12px; }
.user-menu{ position:relative; }
.user-menu summary{
  list-style:none;
  cursor:pointer;
  font-weight:600;
  color:var(--muted);
}
.user-menu summary::-webkit-details-marker{ display:none; }
.user-menu-panel{
  position:absolute;
  right:0;
  top:calc(100% + 4px);
  background:var(--card);
  border:1px solid var(--border);
  border-radius:8px;
  box-shadow:var(--shadow);
  padding:6px 0;
  min-width:150px;
  display:flex;
  flex-direction:column;
  gap:4px;
}
.user-menu[open] .user-menu-panel{ visibility:visible; opacity:1; }
.user-menu-panel a{
  padding:6px 12px;
  color:var(--fg);
  text-decoration:none;
}
.user-menu-panel a:hover{
  background:var(--surface);
}
.logout-form{ margin:0; }
.logout-form button{
  border:1px solid var(--btn-border);
  background:var(--btn-bg);
  border-radius:6px;
  padding:6px 12px;
  cursor:pointer;
}
.logout-form button:hover{ background:var(--btn-hover); }
.login-link{ font-weight:600; }

/* keep leaflet under the topbar */
#leafmap, .leaflet-container, .leaflet-pane { z-index:0; }

/* push the Import button (and following status span) to the right */
#importBtn{ margin-left:auto; }

/* small, muted status text */
#importStatus{ color:var(--muted); }

/* optional: a tiny button style so it looks decent */
button#importBtn{
  padding:6px 10px;
  border:1px solid var(--btn-border);
  border-radius:6px;
  background:var(--btn-bg);
  color:var(--fg);
  cursor:pointer;
}
button#importBtn:hover{ background:var(--btn-hover); }
button#importBtn:disabled{ opacity:.6; cursor:not-allowed; }

/* --- Auth card ----------------------------------------------------------- */
.auth-card{
  max-width:420px;
  margin:48px auto;
  background:var(--card);
  border:1px solid var(--border);
  border-radius:12px;
  padding:24px;
  box-shadow:var(--shadow);
}
.auth-card h1{ margin-top:0; }
.auth-card form{
  display:flex;
  flex-direction:column;
  gap:12px;
}
.form-field{
  display:flex;
  flex-direction:column;
  gap:4px;
}
.form-field label{ font-weight:600; font-size:14px; color:var(--fg); }
.form-field input{
  border:1px solid var(--border);
  border-radius:6px;
  padding:10px 12px;
  font-size:15px;
}
.btn-primary{
  border:none;
  border-radius:6px;
  padding:10px 14px;
  font-size:15px;
  font-weight:600;
  background:#111827;
  color:#fff;
  cursor:pointer;
}
.btn-primary:hover{ background:#0f172a; }
.alert{
  border-radius:6px;
  padding:10px 12px;
  margin-bottom:10px;
  font-weight:500;
}
.alert.error{
  background:#fee2e2;
  border:1px solid #fecaca;
  color:#991b1b;
}
.alert.success{
  background:#dcfce7;
  border:1px solid #bbf7d0;
  color:#166534;
}

/* --- Tables & key/value -------------------------------------------------- */
.tbl{ width:100%; border-collapse:collapse; }
.tbl th,.tbl td{
  text-align:left; padding:8px 6px; border-bottom:1px solid var(--border); color:var(--fg);
}
.kv{ list-style:none; padding:0; margin:0; }
.kv li{
  display:flex; justify-content:space-between; padding:6px 0; border-bottom:1px dotted var(--border);
}
.kv span{ color:var(--muted); }

.activity-actions{
  text-align:right;
  white-space:nowrap;
}
.activity-actions form{
  margin:0;
  display:inline;
}
.btn-danger{
  border:1px solid #fca5a5;
  background:#fee2e2;
  color:#b91c1c;
  border-radius:6px;
  padding:4px 10px;
  font-size:13px;
  cursor:pointer;
}
.btn-danger:hover{
  background:#fecaca;
}
.btn-danger:focus{
  outline:2px solid rgba(185,28,28,0.4);
  outline-offset:1px;
}

.pagination{
  margin-top:12px;
  display:flex;
  gap:6px;
  flex-wrap:wrap;
  align-items:center;
}
.pagination a,
.pagination span{
  padding:4px 10px;
  border:1px solid var(--border);
  border-radius:6px;
  text-decoration:none;
  color:var(--fg);
  font-size:14px;
}
.pagination a:hover{
  background:var(--surface);
}
.pagination .current{
  background:#111827;
  color:#fff;
  border-color:#111827;
}
.pagination span.disabled{
  color:var(--muted);
  border-color:var(--border);
  background:transparent;
}

/* --- Grid ---------------------------------------------------------------- */
.grid{ display:grid; grid-template-columns: 1fr 1fr; gap:16px; }
@media (max-width: 900px){ .grid{ grid-template-columns:1fr; } }

/* --- Cards --------------------------------------------------------------- */
.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:10px;
  padding:10px 12px;
  box-shadow:var(--shadow);
}
.card-head{ font-weight:600; color:#333; }
@media (prefers-color-scheme: dark){
  .card-head{ color:var(--fg); }
}
  .chart-canvas { display:block; width:100%; height:100%; }

/* --- Metrics ------------------------------------------------------------- */
.metrics{
  display:grid; grid-template-columns: repeat(5, minmax(0,1fr));
  gap:12px; margin:6px 0 4px;
}
.metric{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:10px;
  padding:10px 12px;
}
.metric-value{ font-size:22px; font-weight:700; }
.metric-value .metric-unit{ font-size:14px; font-weight:600; color:var(--muted); margin-left:3px; }
.metric-label{ font-size:12px; color:var(--muted); margin-top:2px; }

/* --- Stats grid ---------------------------------------------------------- */
.stats-grid{
  display:grid; grid-template-columns: repeat(4, minmax(0, 1fr));
  gap:10px;
}
.stats-grid > div{
  border:1px solid var(--border); border-radius:8px; padding:8px 10px; background:var(--card);
  display:flex; align-items:center; justify-content:space-between;
}
.stats-grid > div span{ color:var(--muted); }

/* --- Responsive tweaks --------------------------------------------------- */
@media (max-width: 900px){
  .metrics{ grid-template-columns: repeat(2, minmax(0,1fr)); }
  .stats-grid{ grid-template-columns: repeat(2, minmax(0,1fr)); }
}

/* --- Leaflet theming to match cards ------------------------------------- */
.leaflet-container .leaflet-control{
  background:var(--card);
  border:1px solid var(--border);
  color:var(--fg);
}
.leaflet-container .leaflet-bar a, 
.leaflet-container .leaflet-bar a:hover{
  background:var(--card);
  border-bottom:1px solid var(--border);
  color:var(--fg);
}
.leaflet-popup-content-wrapper, .leaflet-popup-tip{
  background:var(--card);
  color:var(--fg);
  border:1px solid var(--border);
}
.leaflet-control-attribution{ background:var(--card); color:var(--muted); border:1px solid var(--border); }
