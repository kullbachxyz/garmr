{{define "content"}}
<h1>Activities</h1>

<form method="GET" class="stats-filter">
  <label for="sport">Filter by sport:</label>
  <select id="sport" name="sport" onchange="this.form.submit()">
    <option value="" {{if eq .CurrentSport ""}}selected{{end}}>All</option>
    {{range .Sports}}
      <option value="{{.}}" {{if eq $.CurrentSport .}}selected{{end}}>{{.}}</option>
    {{end}}
  </select>
</form>

<table class="tbl">
  <tr><th>Start</th><th>Sport</th><th>Distance</th><th>Duration</th><th>Actions</th></tr>
  {{range .Items}}
  <tr>
    <td><a href="/activity/{{.ID}}">{{trimUTC .Start}}</a></td>
    <td>{{.Sport}}</td>
    <td>{{printf "%.2f km" .DistKm}}</td>
    <td>{{fmtDuration .DurS}}</td>
    <td class="activity-actions">
      <form method="POST" action="/activity/delete" onsubmit="return confirm('Delete this activity?');">
        <input type="hidden" name="id" value="{{.ID}}">
        {{if $.CurrentSport}}<input type="hidden" name="sport" value="{{$.CurrentSport}}">{{end}}
        <input type="hidden" name="page" value="{{$.Page}}">
        <button type="submit" class="btn btn-danger">Delete</button>
      </form>
    </td>
  </tr>
  {{else}}
  <tr><td colspan="5">No activities yet.</td></tr>
  {{end}}
</table>

{{if gt .TotalPages 1}}
<div class="pagination">
  {{if .HasPrev}}
    <a href="/activities?{{.PaginationQS}}page={{.PrevPage}}">&laquo; Prev</a>
  {{else}}
    <span class="disabled">&laquo; Prev</span>
  {{end}}

  {{range .PageNumbers}}
    {{if eq $.Page .}}
      <span class="current">{{.}}</span>
    {{else}}
      <a href="/activities?{{$.PaginationQS}}page={{.}}">{{.}}</a>
    {{end}}
  {{end}}

  {{if .HasNext}}
    <a href="/activities?{{.PaginationQS}}page={{.NextPage}}">Next &raquo;</a>
  {{else}}
    <span class="disabled">Next &raquo;</span>
  {{end}}
</div>
{{end}}
{{end}}
